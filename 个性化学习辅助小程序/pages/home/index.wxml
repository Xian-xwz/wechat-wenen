<!-- å­¦ä¹ æ¦‚å†µæ•°æ®å¤§å± -->
<view class="dashboard-container">
  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <view class="dashboard-header">
    <text class="header-title">å­¦ä¹ çœ‹æ¿</text>
    <t-icon name="refresh" size="48rpx" bindtap="onRefresh" class="refresh-icon {{isRefreshing ? 'rotating' : ''}}" />
  </view>

  <!-- æ»šåŠ¨å†…å®¹åŒº -->
  <scroll-view class="dashboard-scroll" scroll-y enable-flex>
    <!-- æ ¸å¿ƒæŒ‡æ ‡å¡ç‰‡åŒº -->
    <view class="stats-cards">
      <view class="stats-card stats-card--primary">
        <view class="stats-icon">ğŸ“š</view>
        <view class="stats-content">
          <text class="stats-value">{{learningStats.totalHours || 0}}</text>
          <text class="stats-label">ç´¯è®¡å­¦ä¹ (å°æ—¶)</text>
        </view>
      </view>
      <view class="stats-card stats-card--success">
        <view class="stats-icon">âœ…</view>
        <view class="stats-content">
          <text class="stats-value">{{learningStats.todayQuestions || 0}}</text>
          <text class="stats-label">ä»Šæ—¥åˆ·é¢˜</text>
        </view>
      </view>
      <view class="stats-card stats-card--warning">
        <view class="stats-icon">ğŸ¯</view>
        <view class="stats-content">
          <text class="stats-value">{{learningStats.accuracy || 0}}%</text>
          <text class="stats-label">å¹³å‡æ­£ç¡®ç‡</text>
        </view>
      </view>
      <view class="stats-card stats-card--danger">
        <view class="stats-icon">ğŸ”¥</view>
        <view class="stats-content">
          <text class="stats-value">{{learningStats.streakDays || 0}}</text>
          <text class="stats-label">è¿ç»­æ‰“å¡(å¤©)</text>
        </view>
      </view>
    </view>

    <!-- å¿«é€Ÿå…¥å£å¡ç‰‡ -->
    <view class="quick-actions">
      <view class="action-card" bindtap="goToQuiz">
        <view class="action-icon action-icon--quiz">ğŸ“</view>
        <text class="action-label">å¼€å§‹åˆ·é¢˜</text>
      </view>
      <view class="action-card" bindtap="goToWrongBook">
        <view class="action-icon action-icon--wrong">ğŸ“–</view>
        <text class="action-label">é”™é¢˜æœ¬</text>
      </view>
      <view class="action-card" bindtap="goToLearningPath">
        <view class="action-icon action-icon--path">ğŸ—ºï¸</view>
        <text class="action-label">å­¦ä¹ è·¯å¾„</text>
      </view>
      <view class="action-card" bindtap="goToDataCenter">
        <view class="action-icon action-icon--data">ğŸ“Š</view>
        <text class="action-label">æ•°æ®ä¸­å¿ƒ</text>
      </view>
    </view>

    <!-- çŸ¥è¯†é›·è¾¾å›¾ -->
    <view class="chart-section">
      <view class="section-header">
        <text class="section-title">çŸ¥è¯†æŒæ¡åº¦</text>
        <text class="section-subtitle">å„çŸ¥è¯†ç‚¹èƒ½åŠ›è¯„ä¼°</text>
      </view>
      <view class="chart-container radar-chart">
        <ec-canvas id="radar-chart" canvas-id="radar-chart" echarts="{{echartsInstance}}" ec="{{radarEc}}"></ec-canvas>
      </view>
    </view>

    <!-- AIå­¦ä¹ åŠ©æ‰‹å¡ç‰‡ -->
    <view class="ai-assistant-section">
      <view class="section-header">
        <text class="section-title">AIå­¦ä¹ åŠ©æ‰‹</text>
        <text class="section-subtitle">Annaéšæ—¶ä¸ºä½ è§£ç­”ç–‘æƒ‘</text>
      </view>
      <view class="ai-card" bindtap="goToAnnaChat">
        <view class="ai-card-bg">
          <view class="ai-avatar">
            <image src="/static/avatar1.png" mode="aspectFit" class="avatar-img" />
          </view>
          <view class="ai-content">
            <text class="ai-greeting">Hiï¼Œæˆ‘æ˜¯ä½ çš„å­¦ä¹ åŠ©æ‰‹Anna</text>
            <text class="ai-suggestion">ä»Šå¤©æƒ³äº†è§£é—­åŒ…å—ï¼Ÿ</text>
            <view class="ai-quick-actions">
              <view class="quick-tag">å˜é‡æå‡</view>
              <view class="quick-tag">åŸå‹é“¾</view>
              <view class="quick-tag">äº‹ä»¶å¾ªç¯</view>
            </view>
          </view>
          <view class="ai-arrow">
            <t-icon name="chevron-right" size="40rpx" color="#FFFFFF" />
          </view>
        </view>
      </view>
    </view>

    <!-- æ¨èä»»åŠ¡æ  -->
    <view class="tasks-section">
      <view class="section-header">
        <text class="section-title">ä»Šæ—¥å¿…åš</text>
        <text class="view-all" bindtap="viewAllTasks">æŸ¥çœ‹å…¨éƒ¨</text>
      </view>
      <view class="task-list">
        <view 
          wx:for="{{dailyTasks}}" 
          wx:key="id"
          class="task-item {{item.completed ? 'task-item--completed' : ''}}"
          bindtap="toggleTask"
          data-id="{{item.id}}"
        >
          <view class="task-checkbox">
            <t-icon name="{{item.completed ? 'check-circle-filled' : 'circle'}}" 
                    size="40rpx" 
                    color="{{item.completed ? '#52C41A' : '#D9D9D9'}}" />
          </view>
          <view class="task-content">
            <text class="task-title">{{item.title}}</text>
            <text class="task-desc">{{item.desc}}</text>
          </view>
          <view class="task-reward">
            <text class="reward-text">+{{item.points}}ç§¯åˆ†</text>
          </view>
        </view>
      </view>
    </view>

    <!-- åº•éƒ¨ç•™ç™½ï¼ˆé€‚é… tabBarï¼‰ -->
    <view class="bottom-spacer"></view>
  </scroll-view>
</view>

<t-message id="t-message" />
